<!DOCTYPE html>
<html>
    <head><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Demo of Communist.js">
    <meta name="author" content="Calvin Metcalf">

    <!-- Le styles -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
        <title>Communist.js</title>
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="apple-touch-icon-114x114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="apple-touch-icon-72x72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-57x57-precomposed.png">
                                   <link rel="shortcut icon" href="favicon.ico"><link rel="stylesheet" href="gh-fork-ribbon.css" />
    <!--[if IE]>
        <link rel="stylesheet" href="gh-fork-ribbon.ie.css" />
    <![endif]-->

    </head>
    <body><div class="github-fork-ribbon-wrapper right">
        <div class="github-fork-ribbon"><!--from http://simonwhitaker.github.com/github-fork-ribbon-css/ -->
            <a href="https://github.com/calvinmetcalf/communist">Fork me on GitHub</a>
        </div>
    </div>
    <div class="container-fluid"> 
<div class="row-fluid"><div class="span4 offset2"><div class="row-fluid"><textarea rows="8" id="func">
function(num){
	var a = 0;
	while(num){
		a = a + num;
		num--;
	};
	return a;
}</textarea></div>
<div class="row-fluid"><strong>Input Value:</strong> adjust as needed<ul><li>takes 4 seconds for me in chrome</li><li>takes over 2 minutes in IE 9, I'd adjust down</li><li><input type="text" value="500000000" id="inp" /></li></ul></div></div><div class="span4">
<div class="row-fluid"><button type="button" id="inProc" class="btn btn-danger">Run In Proccess</button><br/>Results:<span id="res"></span></div>
<div class="row-fluid"><button type="button" id="outProc" class="btn btn-success">Run Out of Proccess</button></div>
<div class="row-fluid">Results:<span id="res2"></span></div>
<div class="row-fluid">Can be blocked: <span id="timeA"></span></div>
<div class="row-fluid">Won't be blocked: <span id="timeB"></span></div>
<div class="row-fluid">Running out of proccess: <span id="timeC"></span></div>
</div>
</div></div><script src="communist.js" type="text/javascript"></script>
<script type="text/javascript">
var timeA = document.getElementById("timeA");
var timeB = document.getElementById("timeB");
var timeC = document.getElementById("timeC");
var t = new Date;
timeA.innerHTML = t.toLocaleTimeString();
timeB.innerHTML = t.toLocaleTimeString();
function setA(){
	t.setSeconds(t.getSeconds()+1);
	timeA.innerHTML = t.toLocaleTimeString();
};
function setB(){
	var d = new Date;
	timeB.innerHTML = d.toLocaleTimeString();
}
function setTimes(){
	setA();
	setB();
}
var si = setInterval(setTimes,1000);
var inProc = document.getElementById("inProc");
var outProc = document.getElementById("outProc");

inProc.onclick = function(){
	eval("var func = "+document.getElementById("func").innerHTML);
	var res = document.getElementById("res");
	res.innerHTML = func(parseInt(document.getElementById("inp").value,10));
	
};
outProc.onclick = function(){
	eval("var func = "+document.getElementById("func").innerHTML);
	var res2 = document.getElementById("res2");
	var async = communist(func);
	async.send(parseInt(document.getElementById("inp").value,10),function(err,data){
		res2.innerHTML = data;
		async.close();
	});
}
var timer = function(){var f = function(){	var d = new Date;this.send(d.toLocaleTimeString())}; var ff = f.bind(this);setInterval(ff,1000);}
var comrade = communist(timer);
comrade.send("",function(err,_data){timeC.innerHTML=_data;})
</script>
    </body>
</html>
