/*! communist 2013-03-18 */
(function(n){"use strict";var e=function(){},t=function(n){var e,t=n.match(/(importScripts\(.*\);)/);return e=t?t[0].replace(/importScripts\((.*)\);?/,function(n,e){return e?"importScripts("+e.split(",").map(function(n){return'"'+i.makeUrl(n.slice(1,-1))+'"'})+");\n":""})+n.replace(/(importScripts\(.*\);?)/,"\n"):n},r=function(n){var e,r=t(n.join(""));if(i.URL=i.URL||window.URL||window.webkitURL||self.URL,window.communist.IEpath){try{e=new Worker(i.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))}catch(a){e=new Worker(window.communist.IEpath),e.postMessage(r)}return e}return new Worker(i.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))},a=function(e,t){var a=new n.Promise,u=r(["var _self={};\n_self.fun = ",e,";\n	_self.cb=function(data,transfer){\n			self.postMessage(data,transfer);\n			self.close();\n		};\n		_self.result = _self.fun(",JSON.stringify(t),',_self.cb);\n		if(typeof _self.result !== "undefined"){\n			_self.cb(_self.result);\n		}']);return u.onmessage=function(n){a.resolve(n.data)},u.onerror=function(n){n.preventDefault(),a.reject(n.message)},a},u=function(n,t,a){var u=new e,f=r(["var _close=function(){self.close();};var _db={};\nvar _self={};\n_self.fun = ",n,';\n		_self.cb=function(data,transfer){\n			self.postMessage(data,transfer);\n		};\n		self.onmessage=function(e){\n		_self.result = _self.fun(e.data,_self.cb);\n			if(typeof _self.result !== "undefined"){\n				_self.cb(_self.result);\n			}\n		}']);return f.onmessage=function(n){t(n.data)},f.onerror=a?a:function(){t()},u.data=function(n,e){return f.postMessage(n,e),u},u.close=function(){return f.terminate()},u},f=function(t){var r=new e,a=[],f=function(n){"string"!=typeof n&&(n.preventDefault(),n=n.message),a.forEach(function(e){e&&e.reject(n)})},o="function(data,cb){var _self={};_self.fun = "+t+';\n		_self.numberCB = function(num,d,tran){\n			cb([num,d],tran);\n		};\n		_self.boundCB = _self.numberCB.bind(null,data[0]);\n		_self.result = _self.fun(data[1],_self.boundCB);\n		if(typeof _self.result !== "undefined"){\n			_self.boundCB(_self.result);\n		}\n	}',s=function(n){a[n[0]].resolve(n[1]),a[n[0]]=0},c=u(o,s,f);return r.close=function(){c.close(),f("closed")},r.data=function(e,t){var r=a.length;return a[r]=new n.Promise,c.data([r,e],t),a[r]},r},o=function(n,t){var r=new e,a="function(dat,cb){ var fun = "+n+';\n		switch(dat[0]){\n			case "data":\n				if(!_db._r){\n					_db._r = dat[1];\n				}else{\n					_db._r = fun(_db._r,dat[1]);\n				}\n				break;\n			case "get":\n				return cb(_db._r);\n			case "close":\n				cb(_db._r);\n				_close();\n				break;\n		}\n	};',f=function(n){t(n)},o=u(a,f);return r.data=function(n,e){return o.data(["data",n],e),r},r.fetch=function(){return o.data(["get"]),r},r.close=function(n){n&&(t=function(){}),o.data(["close"])},r},s=function(t){function r(){for(var n=0,e=l.length;e>n&&i>0&&p>0;)i--,l[n].data(d.pop()),n++,p--;return c}function a(){s.close(),l.forEach(function(n){n.close()})}var f,s,c=new e,i=0,l=[],d=[],p=t,_=!1,m=!1,b={map:!1,reduce:!1,data:!1},v=function(){return b.map&&b.reduce&&b.data?r():c};return c.map=function(n,e){if(b.map)return c;for(var r=0;t>r;)(function(){var r,f=u(n,function(n){void 0!==typeof n&&s.data(n),i>0?(i--,r=d.pop(),e?f.data(r,[r]):f.data(r)):(p++,p===t&&(b.data=!1,m?a():_&&(_=!1,s.fetch())))});l.push(f)})(),r++;return b.map=!0,v()},c.reduce=function(n){return b.reduce?c:(s=o(n,function(n){f&&(f.resolve(n),f=!1)}),b.reduce=!0,v())},c.data=function(n){return m?void 0:(i+=n.length,d=d.concat(n),b.data=!0,v())},c.fetch=function(e){return f||(f=new n.Promise),t>p&&!e?_=!0:s.fetch(),f},c.close=function(){return f||(f=new n.Promise),t>p?m=!0:a(),f},c},c=function(n){function t(){return u.data&&u.map&&u.reduce?a.close():r}var r=new e,a=s(n),u={data:!1,map:!1,reduce:!1};return r.map=function(n,e){return u.map=!0,a.map(n,e),t()},r.reduce=function(n){return u.reduce=!0,a.reduce(n),t()},r.data=function(n){return u.data=!0,a.data(n),t()},r},i=function(n,e,t){return"number"!=typeof n&&"function"==typeof e?u(n,e,t):"number"!=typeof n?e?a(n,e):f(n):"number"==typeof n?e?s(n):c(n):void 0};i.reducer=o,i.worker=r,i.makeUrl=function(n){var e=document.createElement("link");return e.href=n,e.href},i.ajax=function(n,e,t){var r=t?"request.responseText":"JSON.parse(request.responseText)",a=e?"("+(""+e)+")("+r+",_cb)":r,u='function (url, _cb) {\n		var request = new XMLHttpRequest();\n		request.open("GET", url);\n			request.onreadystatechange = function() {\n				var _resp;\n				if (request.readyState === 4 && request.status === 200) {\n_resp = '+a+';\n					if(typeof _resp!=="undefined"){_cb(_resp);}\n					}\n			};\n		request.send();\n	}';return i(u,i.makeUrl(n))},window.communist=i})(RSVP);